var sliderizr;!function(e){angular.module("sliderizr",["ngAnimate"]).constant("_",_)}(sliderizr||(sliderizr={})),angular.module("sliderizr").run(["$templateCache",function(e){e.put("templates/sliderizr/panel-inner.html","<div><header><h1>{{$title}}</h1><button ng-click=$close() class=btn-close>close</button></header><div class=panel-body ng-transclude></div></div>"),e.put("templates/sliderizr/panel.html","<div class=site-panel ng-click=$setActive() ng-class=\"{active: $active, 'panel-sm': $panelSize == 1, 'panel-md': $panelSize == 2}\"></div>")}]);var sliderizr;!function(e){"use strict";function t(){return new n}var n=function(){function e(){this.routes={},this.config={panelTemplateUrl:"templates/sliderizr/panel.html",panelInnerTemplateUrl:"templates/sliderizr/panel-inner.html"}}return e.prototype.when=function(e,t){return this.routes[e]=angular.copy(t),this},e.prototype.otherwise=function(e){var t="string"==typeof e?{redirectTo:e}:e;return this.when(null,t)},e.prototype.$get=function(){return new r(this.routes,this.config)},e}(),r=function(){function e(e,t){this.routes=e,this.config=t}return e}();angular.module("sliderizr").provider("panelRoute",t)}(sliderizr||(sliderizr={}));var sliderizr;!function(e){"use strict";function t(e,t,r,i,o,a,s,l,c,u,p,h){return new n(e,t,r,i,o,a,s,l,c,u,p,h)}var n=function(){function e(e,t,n,r,i,o,a,s,l,c,u,p){var h=this;this.$rootScope=e,this.$controller=t,this.$compile=n,this.panelRoute=r,this.$q=i,this._=o,this.$animate=a,this.$timeout=s,this.panelUrlService=l,this.$injector=c,this.$sce=u,this.$templateRequest=p,this.openPanels=[],this.loadPanelsFromPath(),$(window).on("hashchange",function(t){e.$apply(function(){h.onLocationChanged()})})}return e.prototype.getActivePanel=function(){var e=this._.find(this.openPanels,function(e){return e.panelScope.$active});return e.instance},e.prototype.getAllOpenPanels=function(){return this._.map(this.openPanels,function(e){return e.instance})},e.prototype.close=function(e,t){var n=this,r=this.getPanelByInstance(e);this.closeBranch(r).then(function(){return n.updateUrl(),n.setActive(),r.deferred.resolve(t),null})},e.prototype.open=function(e,t,n){var r,i=this,o="object"==typeof e?e:{name:e};t&&t.result?r=t:(o.params=t,r=n);var a=this.findExistingPanel(o,r);if(a)return this.setActive(a.panelScope),a.instance;var s=this.createPanel(o,r);return s.opened.then(function(){return i.$animate.enabled(!0),i.updateUrl(),null}),s},e.prototype.createPanelScope=function(e,t,n,r){var i=this,o=(r?this.getPanelByInstance(r).panelScope:this.$rootScope).$new();return o.$close=function(t){i.close(e,t)},o.$dismiss=function(t){i.dismiss(e,t)},o.$setActive=function(){i.setActive(o,!0)},o.$title=n||"No Title",o.$active=!1,o.$openChildPanel=function(t,n){i.open(t,n,e)},o.$panelSize=t.size||3,e.setTitle=function(e){o.$title=e},o},e.prototype.createPanelInstance=function(e,t,n){var r=this,i={opened:t,result:n,options:e,close:function(e){r.close(i,e)},dismiss:function(e){r.dismiss(i,e)},setActive:function(){r.setActive(i)},setTitle:function(){},openChild:function(e,t){return r.open(e,t||i,i)},beforeClose:function(){return r.$q.when()}};return i},e.prototype.createController=function(e,t,n,r){var i=angular.extend({$panelInstance:t,$scope:n},r),o=this.$controller(e.controller,i);e.controllerAs&&(n[e.controllerAs]=o)},e.prototype.createPanelElement=function(e,t){var n=this,r=this.$sce.getTrustedResourceUrl(e),i=this.$sce.getTrustedResourceUrl(this.panelRoute.config.panelTemplateUrl);return this.$q.all([this.$templateRequest(i),this.$templateRequest(r)]).then(function(e){var r=angular.element(e[0]).html(e[1]);return n.$compile(r)(t)})},e.prototype.createPanel=function(e,t){var n,r=this,i=this.$q.defer(),o=this.$q.defer();if(e.name){if(n=this.panelRoute.routes[e.name]||this.panelRoute.routes["null"],n&&n.redirectTo&&(e="string"==typeof n.redirectTo?{name:n.redirectTo}:n.redirectTo,n=this.panelRoute.routes[e.name]),!n)throw new Error('No route found with the name "'+e.name+'"')}else n=e;var a=this.createPanelInstance(e,o.promise,i.promise);return this.prepareToOpenPanel(n,e,t).then(function(s){var l=r.createPanelScope(a,n,e.title||n.title,t);r.setActive(l),n.controller&&r.createController(n,a,l,s),r.createPanelElement(n.templateUrl,l).then(function(e){var n={deferred:i,instance:a,panelScope:l,element:e,parent:r.getPanelByInstance(t)};r.openPanels.push(n),angular.element(".panel-container").append(e),r.$animate.addClass(e,"open").then(function(){o.resolve(a)})})}),a},e.prototype.dismiss=function(e,t){var n=this.getPanelByInstance(e);this.closeBranch(n).then(function(){n.deferred.reject(t)})},e.prototype.setActive=function(e,t){var n=this;if(this.setActivePromise){if(t)return;this.$timeout.cancel(this.setActivePromise),this.setActivePromise=null}e||(e=this.openPanels[this.openPanels.length-1].panelScope);var r=function(){if(n.setActivePromise=null,n.openPanels.forEach(function(e){return e.panelScope.$active=!1}),e&&!e.$openChildPanel){var t=n.getPanelByInstance(e);e=t?t.panelScope:null}e&&(e.$active=!0)};t?r():this.setActivePromise=this.$timeout(r,100)},e.prototype.closeAll=function(){var e=this.$q.defer();if(this.openPanels.length>0){var t=this.openPanels[0];this.closeBranch(t).then(function(){t.deferred.reject(),e.resolve()},e.reject)}else e.resolve();return e.promise},e.prototype.prepareToOpenPanel=function(e,t,n){var r=this,i=[],o={};return(e.resolve||t.resolve)&&(o=angular.extend({},e.resolve||{},t.resolve||{}),angular.forEach(o,function(e,t){i.push(angular.isString(e)?r.$injector.get(e):r.$injector.invoke(e,null,t))})),i.push(n?this.closeChildren(_.find(this.openPanels,{instance:n}),!1):this.closeAll()),this.$q.all(i).then(function(e){var t={},n=0;return angular.forEach(o,function(r,i){t[i]=e[n++]}),t})},e.prototype.findExistingPanel=function(e,t){var n=this;if(!e.name)return null;var r=this.getPanelByInstance(t);return this._.find(this.openPanels,function(t){return(e===t.instance.options||n.compareOptions(e,t.instance.options))&&t.parent==r})},e.prototype.compareOptions=function(e,t){var n;if(e.name!==t.name)return!1;for(n in e.params)if(e.params.hasOwnProperty(n)&&e.params[n]!==t.params[n])return!1;for(n in t.params)if(t.params.hasOwnProperty(n)&&e.params[n]!==t.params[n])return!1;return!0},e.prototype.onLocationChanged=function(){var e=this;this.panelUrlService.isUrlCurrent(this.currentUrl)||this.closeAll().then(function(){e.loadPanelsFromPath()},function(){e.updateUrl()})},e.prototype.loadPanelsFromPath=function(){var e=this;this.$animate.enabled(!1);var t=this.panelUrlService.deserializeUrl(),n=function(r,i){var o=t[r];e.createPanel({name:o.name,params:o.params},i).opened.then(function(i){r+1<t.length?n(r+1,i):(e.$animate.enabled(!0),e.setActive(),e.updateUrl())})};n(0,null)},e.prototype.closeChildren=function(e,t){var n=this,r=this.$q.defer(),i=this.getChildPanels(e),o=function(e){i.splice(0,1),n.closeBranch(e).then(function(){e.deferred.reject(),i.length>0?o(i[0]):r.resolve()},function(){r.reject()})};return i.length>0?o(i[0]):r.resolve(),r.promise},e.prototype.closeBranch=function(e){var t=this,n=this.$q.defer();return this.closeChildren(e).then(function(){e.instance.beforeClose().then(function(){t.removePanel(e).then(function(){n.resolve()})},function(){n.reject()})},function(){n.reject()}),n.promise},e.prototype.getChildPanels=function(e){return this._.where(this.openPanels,{parent:e})},e.prototype.getPanelByInstance=function(e){return this._.find(this.openPanels,{instance:e})},e.prototype.removePanel=function(e){var t=this,n=this.$q.defer();return this.$animate.removeClass(e.element,"open").then(function(){var r=t.openPanels.indexOf(e);e.element.remove(),t.openPanels.splice(r,1),n.resolve(),e.panelScope.$destroy()}),n.promise},e.prototype.updateUrl=function(){this.currentUrl=this.getOpenPanelUrl(),window.location.hash=this.currentUrl},e.prototype.getOpenPanelUrl=function(){return this.panelUrlService.createUrl(_.map(this.openPanels,function(e){return e.instance}))},e}();e.PanelService=n,t.$inject=["$rootScope","$controller","$compile","panelRoute","$q","_","$animate","$timeout","panelUrlService","$injector","$sce","$templateRequest"],angular.module("sliderizr").factory("panelService",t)}(sliderizr||(sliderizr={}));var sliderizr;!function(e){"use strict";function t(){return new n}var n=function(){function e(){this.pageDividerChar="/",this.queryIndicatorChar=";",this.queryDividerChar=",",this.queryEqualityChar="="}return e.prototype.createUrl=function(e){var t=this,n=!1,r="";return e.forEach(function(e){if(e.options.name){r+=t.pageDividerChar,r+=e.options.name,n=!1;for(var i in e.options.params)e.options.params.hasOwnProperty(i)&&(n?r+=t.queryDividerChar:(r+=t.queryIndicatorChar,n=!0),r+=i+t.queryEqualityChar+e.options.params[i])}}),r},e.prototype.deserializeUrl=function(e){var t=this,n=[],r=(e||this.getWindowLocation()||"").replace(/\\/g,this.pageDividerChar);0===r.indexOf("/")&&(r=r.substr(1)),r||(r="dashboard");var i,o=r.split(this.pageDividerChar);return o.forEach(function(e){var r,o=e.indexOf(t.queryIndicatorChar),a=e;if(o>0){a=e.substr(0,o);var s=e.substr(o+1).split(t.queryDividerChar);r=t.parseRouteParams(s)}var l={name:a,params:r||{}};n.push(l),i=l}),n},e.prototype.parseRouteParams=function(e){var t=this,n={};return e.forEach(function(e){var r=e.split(t.queryEqualityChar);n[r[0]]=r[1]}),n},e.prototype.isUrlCurrent=function(e){return this.getWindowLocation()===e},e.prototype.getWindowLocation=function(){var e=window.location.hash;return e.indexOf("#")>=0?e.substr(1):e},e}();angular.module("sliderizr").factory("panelUrlService",t)}(sliderizr||(sliderizr={}));var sliderizr;!function(e){"use strict";function t(e,t){function n(e,t){function n(){r&&r.stop(!0,!1),r=a,a.animate({scrollLeft:i()},200,function(){r=null})}function i(){var e,n=a.scrollLeft(),r=a.outerWidth(),i=o(),s=t.prev(),l=0===s.length?0:s.offset().left+s.outerWidth()-a.offset().left+n,c=l+i;if(n>l)e=l;else{if(!(c-r>n))return;e=c-r+50}return e}function o(){if(!t.is(".open-add"))return t.outerWidth();var e=$("<div />").attr("class",t.attr("class")).removeClass("open-add").removeClass("open-add-active").appendTo(t.parent()),n=e.outerWidth();return e.remove(),n}var a=t.parent();e.$watch("$active",function(e){e&&n()})}var r,i={restrict:"C",transclude:!0,templateUrl:t.config.panelInnerTemplateUrl,link:n};return i}t.$inject=["$timeout","panelRoute"],angular.module("sliderizr").directive("sitePanel",t)}(sliderizr||(sliderizr={}));var sliderizr;!function(e){"use strict";function t(){function e(){}var t={restrict:"C",link:e};return t}angular.module("sliderizr").directive("panelContainer",t)}(sliderizr||(sliderizr={}));